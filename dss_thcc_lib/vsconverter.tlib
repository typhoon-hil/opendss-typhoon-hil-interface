// Edit only the code, do not open and save from TSE.
// See the file "tse_component_edit.tlib" if you want to edit this component on TSE.
library "OpenDSS" {

    component Subsystem Root {
        component Subsystem VSConverter {
            layout = static
            label = "VSC"
            component "core/abc to dq" "abc to dq1" {
            }
            [
                position = 7440, 8248
                hide_name = True
                size = 48, 80
            ]

            component "core/Constant" Constant3 {
                execution_rate = "execution_rate"
                value = "0"
            }
            [
                position = 7096, 8360
                rotation = left
                hide_name = True
            ]

            component "core/abc to dq" "abc to dq2" {
            }
            [
                position = 9232, 8936
                hide_name = True
                size = 48, 80
            ]

            component "core/Product" Product1 {
            }
            [
                position = 10296, 8792
                hide_name = True
            ]

            component "core/Gain" Gain9 {
                gain = "1.5"
            }
            [
                position = 10376, 8792
                hide_name = True
            ]

            component "core/Probe" P_gen {
                signal_name = "P"
                signal_type = "active power"
            }
            [
                position = 10496, 8752
                rotation = left
            ]

            component "core/Product" Product4 {
            }
            [
                position = 10296, 8896
                hide_name = True
            ]

            component "core/Gain" Gain10 {
                gain = "-1.5"
            }
            [
                position = 10376, 8896
                hide_name = True
            ]

            component "core/Probe" Q_gen {
                signal_name = "Q"
                signal_type = "active power"
            }
            [
                position = 10496, 8856
                rotation = left
            ]

            component "core/Sum" Sum7 {
                signs = "+-"
            }
            [
                position = 6712, 8792
                hide_name = True
            ]

            component "core/Integrator" Integrator3 {
                limit_lower = "-1000*vdc_set*0.05"
                limit_output = "True"
                limit_upper = "1000*vdc_set*0.05"
            }
            [
                position = 7448, 9008
                hide_name = True
            ]

            component "core/Sum" Sum8 {
                signs = "++"
            }
            [
                position = 7536, 8944
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch3" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7016, 8928
                hide_name = True
            ]

            component "core/Constant" Constant4 {
                execution_rate = "execution_rate"
                value = "0"
            }
            [
                position = 6984, 9056
                rotation = left
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch4" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7152, 8944
                hide_name = True
            ]

            component "core/Sum" Sum9 {
                signs = "+-"
            }
            [
                position = 6808, 8400
                hide_name = True
            ]

            component "core/Integrator" Integrator4 {
                limit_lower = "-1000*vdc_set*0.05"
                limit_output = "True"
                limit_upper = "1000*vdc_set*0.05"
            }
            [
                position = 7472, 8632
                hide_name = True
            ]

            component "core/Gain" Gain13 {
                gain = "P_ki"
            }
            [
                position = 7320, 8616
                hide_name = True
            ]

            component "core/Gain" Gain14 {
                gain = "P_kp"
            }
            [
                position = 7320, 8496
                hide_name = True
            ]

            component "core/Sum" Sum10 {
                signs = "++"
            }
            [
                position = 7560, 8624
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch5" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7112, 8560
                hide_name = True
            ]

            component "core/Constant" Constant5 {
                execution_rate = "execution_rate"
                value = "0"
            }
            [
                position = 7080, 8648
                rotation = left
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch6" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7200, 8576
                hide_name = True
            ]

            component "core/Sum" Sum11 {
                signs = "+-"
            }
            [
                position = 6720, 8960
                hide_name = True
            ]

            component "core/Probe" V_gen {
                signal_name = "V"
                signal_type = "voltage"
            }
            [
                position = 7872, 8064
            ]

            component "core/Gain" Gain21 {
                gain = "0.001"
            }
            [
                position = 10464, 8792
                hide_name = True
            ]

            component "core/Gain" Gain22 {
                gain = "0.001"
            }
            [
                position = 10464, 8896
                hide_name = True
            ]

            component "core/Gain" Gain23 {
                gain = "1.224745"
            }
            [
                position = 7768, 8120
                hide_name = True
            ]

            component "core/Constant" Constant9 {
                execution_rate = "execution_rate"
                value = "ext_mode"
            }
            [
                position = 7248, 9176
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch12" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 6920, 8912
                hide_name = True
            ]

            component "core/Gain" Gain24 {
                gain = "Q_kp"
            }
            [
                position = 7296, 8872
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch13" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7392, 8888
                hide_name = True
            ]

            component "core/Gain" Gain25 {
                gain = "V_kp"
            }
            [
                position = 7296, 8904
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch14" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7368, 9008
                hide_name = True
            ]

            component "core/Gain" Gain26 {
                gain = "Q_ki"
            }
            [
                position = 7280, 8992
                hide_name = True
            ]

            component "core/Gain" Gain27 {
                gain = "V_ki"
            }
            [
                position = 7280, 9024
                hide_name = True
            ]

            component "core/C function" "C function1" {
                input_terminals = "real mode_external;inherit Mode_select_ext;inherit Mode_select_int;"
                input_terminals_dimensions = "inherit;inherit;inherit"
                input_terminals_feedthrough = "True;True;True"
                input_terminals_show_labels = "True;True;True"
                output_fnc = "/*Begin code section*/
if (mode_external) {
    if (Mode_select_ext==0) {
        dED_sel = 0;
        dEQ_sel = 1;
        GF_en = 0;
    }
    else if (Mode_select_ext==1) {
        dED_sel = 1;
        dEQ_sel = 1;
        GF_en = 0;
    }
    else if (Mode_select_ext==2) {
        dED_sel = 0;
        dEQ_sel = 0;
        GF_en = 0;
    }
    else if (Mode_select_ext==3) {
        dED_sel = 1;
        dEQ_sel = 0;
        GF_en = 0;
    }
    else if (Mode_select_ext==4) {
        dED_sel = 0;
        dEQ_sel = 0;
        GF_en = 1;
    }
    else {
        dED_sel = 0;
        dEQ_sel = 1;
        GF_en = 0;
    }
}
else {
    if (Mode_select_int==0) {
        dED_sel = 0;
        dEQ_sel = 1;
        GF_en = 0;
    }
    else if (Mode_select_int==1) {
        dED_sel = 1;
        dEQ_sel = 1;
        GF_en = 0;
    }
    else if (Mode_select_int==2) {
        dED_sel = 0;
        dEQ_sel = 0;
        GF_en = 0;
    }
    else if (Mode_select_int==3) {
        dED_sel = 1;
        dEQ_sel = 0;
        GF_en = 0;
    }
    else if (Mode_select_int==4) {
        dED_sel = 0;
        dEQ_sel = 0;
        GF_en = 1;
    }
    else {
        dED_sel = 0;
        dEQ_sel = 1;
        GF_en = 0;
    }
}
/*End code section*/"
                output_terminals = "real dED_sel;real dEQ_sel;real GF_en;"
                output_terminals_dimensions = "inherit;inherit;inherit"
                output_terminals_feedthrough = "True;True;True"
                output_terminals_show_labels = "True;True;True"
            }
            [
                position = 7432, 9200
                hide_name = True
                size = 192, 96
            ]

            component "core/Constant" Constant13 {
                execution_rate = "execution_rate"
                value = "ctrl_mode_int"
            }
            [
                position = 7248, 9224
                hide_name = True
            ]

            component "core/Gain" Gain28 {
                gain = "vdc_kp"
            }
            [
                position = 7320, 8528
                hide_name = True
            ]

            component "core/Gain" Gain29 {
                gain = "vdc_ki"
            }
            [
                position = 7320, 8648
                hide_name = True
            ]

            component "core/Sum" Sum14 {
                signs = "+-"
            }
            [
                position = 6928, 8672
                hide_name = True
            ]

            component "core/Gain" Gain30 {
                gain = "1000"
            }
            [
                position = 6768, 8664
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch15" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7392, 8512
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch16" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7400, 8632
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch17" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7024, 8544
                hide_name = True
            ]

            component "core/Constant" Constant14 {
                execution_rate = "execution_rate"
            }
            [
                position = 6688, 9200
                hide_name = True
            ]

            component "core/Gain" Gain32 {
            }
            [
                position = 7184, 9200
                hide_name = True
            ]

            component "core/Signal Controlled Voltage Source" Vinv_a {
            }
            [
                position = 8304, 9568
                rotation = left
                scale = 1, -1
                size = 64, 32
            ]

            component "core/Signal Controlled Voltage Source" Vinv_b {
            }
            [
                position = 8376, 9632
                rotation = left
                scale = 1, -1
                size = 64, 32
            ]

            component "core/Signal Controlled Voltage Source" Vinv_c {
            }
            [
                position = 8448, 9704
                rotation = left
                scale = 1, -1
                size = 64, 32
            ]

            component "core/Resistor" Ra {
                resistance = "Rac"
            }
            [
                position = 8560, 9424
            ]

            component "core/Resistor" Rb {
                resistance = "Rac"
            }
            [
                position = 8560, 9504
            ]

            component "core/Resistor" Rc {
                resistance = "Rac"
            }
            [
                position = 8560, 9584
            ]

            component "core/Inductor" La {
                inductance = "Lac"
            }
            [
                position = 8688, 9424
            ]

            component "core/Inductor" Lb {
                inductance = "Lac"
            }
            [
                position = 8688, 9504
            ]

            component "core/Inductor" Lc {
                inductance = "Lac"
            }
            [
                position = 8696, 9584
            ]

            component "core/Current Measurement" Ia {
                execution_rate = "execution_rate"
                sig_output = "True"
            }
            [
                position = 8808, 9424
                size = 64, 32
            ]

            component "core/Current Measurement" Ib {
                execution_rate = "execution_rate"
                sig_output = "True"
            }
            [
                position = 8808, 9504
                size = 64, 32
            ]

            component "core/Current Measurement" Ic {
                execution_rate = "execution_rate"
                sig_output = "True"
            }
            [
                position = 8808, 9584
                size = 64, 32
            ]

            component "core/Voltage Measurement" Va {
                execution_rate = "execution_rate"
                sig_output = "True"
            }
            [
                position = 8960, 9688
                rotation = right
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vb {
                execution_rate = "execution_rate"
                sig_output = "True"
            }
            [
                position = 9040, 9688
                rotation = right
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vc {
                execution_rate = "execution_rate"
                sig_output = "True"
            }
            [
                position = 9120, 9688
                rotation = right
                size = 64, 32
            ]

            component "core/Sum" Sum15 {
                signs = "+-"
            }
            [
                position = 10296, 8488
                hide_name = True
            ]

            component "core/Sum" Sum16 {
                signs = "+-"
            }
            [
                position = 10296, 8592
                hide_name = True
            ]

            component "core/Sum" Sum17 {
                signs = "+-"
            }
            [
                position = 10296, 8696
                hide_name = True
            ]

            component "core/Probe" Vab {
                signal_name = "V"
                signal_type = "voltage"
            }
            [
                position = 10384, 8488
            ]

            component "core/Probe" Vbc {
                signal_name = "V"
                signal_type = "voltage"
            }
            [
                position = 10384, 8592
            ]

            component "core/Probe" Vca {
                signal_name = "V"
                signal_type = "voltage"
            }
            [
                position = 10384, 8696
            ]

            component Subsystem Subsystem8 {
                layout = dynamic
                component "core/Product" Product5 {
                }
                [
                    position = 8080, 7888
                    hide_name = True
                ]

                component "core/Sum" Sum16 {
                }
                [
                    position = 8160, 7920
                    hide_name = True
                ]

                component "core/Mathematical function" "Mathematical function2" {
                    mathematical_fn = "sqrt"
                }
                [
                    position = 8264, 7920
                    hide_name = True
                ]

                component "core/Product" Product4 {
                }
                [
                    position = 8080, 7968
                    hide_name = True
                ]

                component "core/Trigonometric function" "Trigonometric function4" {
                    trigonometric_fn = "asin"
                }
                [
                    position = 8688, 8032
                    hide_name = True
                ]

                component "core/Product" Product7 {
                    signs = "*/"
                }
                [
                    position = 8512, 7872
                    hide_name = True
                ]

                component "core/Relational operator" "Relational operator2" {
                }
                [
                    position = 8344, 7992
                    hide_name = True
                ]

                component "core/Constant" Constant5 {
                    execution_rate = "execution_rate"
                    value = "0"
                }
                [
                    position = 8264, 8000
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch4" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 8768, 8016
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch12" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 8392, 8080
                    hide_name = True
                ]

                component "core/Sum" Sum19 {
                }
                [
                    position = 8232, 8072
                    hide_name = True
                ]

                component "core/Constant" Constant6 {
                    execution_rate = "execution_rate"
                    value = "0.001"
                }
                [
                    position = 8152, 8080
                    hide_name = True
                ]

                component "core/Constant" Constant7 {
                    execution_rate = "execution_rate"
                    value = "0"
                }
                [
                    position = 8608, 8000
                    hide_name = True
                ]

                component "core/Comparator" Comparator4 {
                }
                [
                    position = 8264, 8160
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch13" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 9000, 8208
                    hide_name = True
                ]

                component "core/Sum" Sum20 {
                    signs = "+-"
                }
                [
                    position = 8880, 8360
                    hide_name = True
                ]

                component "core/Constant" Constant8 {
                    execution_rate = "execution_rate"
                    value = "np.pi"
                }
                [
                    position = 8744, 8352
                    hide_name = True
                ]

                component "core/Comparator" Comparator5 {
                }
                [
                    position = 9008, 8312
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch14" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 9072, 8360
                    hide_name = True
                ]

                component "core/Sum" Sum21 {
                    signs = "+-"
                }
                [
                    position = 8888, 8432
                    hide_name = True
                ]

                component "core/Constant" Constant9 {
                    execution_rate = "execution_rate"
                    value = "-np.pi"
                }
                [
                    position = 8744, 8424
                    hide_name = True
                ]

                component "core/Constant" Constant10 {
                    execution_rate = "execution_rate"
                    value = "0"
                }
                [
                    position = 8944, 8328
                    hide_name = True
                ]

                port mag {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8336, 7920
                ]

                port d {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7776, 8304
                ]

                port q {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7696, 7872
                ]

                port Angle {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9072, 8208
                ]

                junction Junction24 sp
                [
                    position = 8032, 7896
                ]

                junction Junction29 sp
                [
                    position = 8024, 7976
                ]

                junction Junction33 sp
                [
                    position = 7824, 8304
                ]

                junction Junction35 sp
                [
                    position = 8304, 7920
                ]

                junction Junction37 sp
                [
                    position = 8392, 7992
                ]

                junction Junction38 sp
                [
                    position = 8304, 7984
                ]

                junction Junction39 sp
                [
                    position = 8304, 8024
                ]

                junction Junction40 sp
                [
                    position = 8184, 8080
                ]

                junction Junction43 sp
                [
                    position = 8816, 8192
                ]

                junction Junction44 sp
                [
                    position = 8816, 8304
                ]

                junction Junction45 sp
                [
                    position = 8816, 8368
                ]

                junction Junction46 sp
                [
                    position = 7792, 7872
                ]

                connect Product4.in1 Junction29 as Connection222
                connect Product4.in Junction29 as Connection224
                connect Product4.out Sum16.in1 as Connection236
                connect Product5.in1 Junction24 as Connection228
                connect Product5.in Junction24 as Connection235
                connect Junction33 d as Connection238
                connect "Mathematical function2.in" Sum16.out as Connection234
                connect Sum16.in Product5.out as Connection231
                connect mag Junction35 as Connection252
                connect Junction35 "Mathematical function2.out" as Connection253
                [
                    position = 0, 0
                ]
                connect Constant5.out "Relational operator2.in1" as Connection255
                connect Junction33 Junction29 as Connection257
                [
                    position = 0, 0
                ]
                connect "Trigonometric function4.out" "Signal switch4.in1" as Connection262
                connect "Relational operator2.out" Junction37 as Connection263
                connect Junction37 "Signal switch4.in2" as Connection264
                [
                    position = 0, 0
                ]
                connect "Signal switch12.in2" Junction37 as Connection265
                connect Product7.out "Trigonometric function4.in" as Connection266
                connect "Relational operator2.in" Junction38 as Connection267
                connect Junction38 Junction35 as Connection268
                connect "Signal switch12.out" Product7.in1 as Connection270
                connect "Signal switch12.in1" Junction39 as Connection271
                connect Junction39 Junction38 as Connection272
                connect Sum19.in Junction39 as Connection273
                connect Sum19.out "Signal switch12.in" as Connection275
                connect Constant7.out "Signal switch4.in" as Connection276
                connect Constant6.out Junction40 as Connection277
                connect Junction40 Sum19.in1 as Connection278
                connect Comparator4.in2 Junction40 as Connection279
                connect Comparator4.out "Signal switch13.in2" as Connection283
                connect Junction43 "Signal switch13.in" as Connection290
                [
                    position = 0, 0
                ]
                connect Comparator5.out "Signal switch14.in2" as Connection292
                connect "Signal switch4.out" Junction43 as Connection294
                [
                    position = 0, 0
                ]
                connect Constant8.out Sum20.in as Connection295
                connect Comparator5.in1 Junction44 as Connection296
                connect Junction44 Junction43 as Connection297
                connect Constant9.out Sum21.in as Connection299
                connect Sum20.in1 Junction45 as Connection300
                connect Junction45 Junction44 as Connection301
                connect Sum21.in1 Junction45 as Connection302
                connect Sum20.out "Signal switch14.in" as Connection303
                connect Sum21.out "Signal switch14.in1" as Connection304
                connect Constant10.out Comparator5.in2 as Connection305
                connect "Signal switch14.out" "Signal switch13.in1" as Connection306
                connect Angle "Signal switch13.out" as Connection307
                connect Comparator4.in1 Junction33 as Connection312
                [
                    position = 0, 0
                ]
                connect Product7.in Junction46 as Connection314
                connect Junction46 Junction24 as Connection315
                [
                    position = 0, 0
                ]
                connect q Junction46 as Connection316
            }
            [
                position = 7584, 8176
                rotation = right
                hide_name = True
                scale = 1, -1
                size = 48, 64
            ]

            component "core/Comparator" Comparator1 {
            }
            [
                position = 8224, 8264
                hide_name = True
            ]

            component "core/Clock" Clock1 {
                execution_rate = "execution_rate"
            }
            [
                position = 8080, 8256
                hide_name = True
            ]

            component "core/Constant" Constant21 {
                execution_rate = "execution_rate"
                value = "cont_t"
            }
            [
                position = 8128, 8296
                hide_name = True
            ]

            component "core/Constant" Constant22 {
                execution_rate = "execution_rate"
                value = "Sinv"
            }
            [
                position = 6224, 8384
                hide_name = True
            ]

            component "core/Constant" Constant23 {
                execution_rate = "execution_rate"
                value = "Qinv"
            }
            [
                position = 6224, 8424
                hide_name = True
            ]

            component "core/Constant" Constant24 {
                execution_rate = "execution_rate"
                value = "Fs"
            }
            [
                position = 6224, 8344
                hide_name = True
            ]

            component "core/Constant" Constant25 {
                execution_rate = "execution_rate"
                value = "vac_set"
            }
            [
                position = 6224, 8472
                hide_name = True
            ]

            component "core/dq to abc" "dq to abc1" {
                execution_rate = "inherit"
            }
            [
                position = 8832, 8816
                size = 48, 80
            ]

            component "core/Constant" Constant27 {
                execution_rate = "execution_rate"
                value = "0"
            }
            [
                position = 8744, 8872
                rotation = left
                hide_name = True
            ]

            component "core/Gain" Gain33 {
                gain = "2*np.pi"
            }
            [
                position = 6976, 8248
                hide_name = True
            ]

            component "core/Constant" Constant28 {
                execution_rate = "execution_rate"
                value = "2*np.pi"
            }
            [
                position = 7016, 8360
                rotation = left
                hide_name = True
            ]

            component "core/C function" "C function2" {
                global_variables = "real out_mem;"
                init_fnc = "/*Begin code section*/
out_mem = ang_init;
/*End code section*/"
                input_terminals = "real in;real reset_level;real dt;real ang_init;"
                input_terminals_dimensions = "inherit;inherit;inherit;inherit"
                input_terminals_feedthrough = "True;True;True;True"
                input_terminals_show_labels = "True;True;True;True"
                output_fnc = "/*Begin code section*/
out = dt * in + out_mem;
if (out>reset_level) {
    out = out - reset_level;
}

out_mem = out;
/*End code section*/"
                output_terminals_dimensions = "inherit"
                output_terminals_feedthrough = "True"
                output_terminals_show_labels = "True"
            }
            [
                position = 7208, 8272
                hide_name = True
                size = 112, 80
            ]

            component "core/Constant" Constant30 {
                execution_rate = "execution_rate"
                value = "execution_rate"
            }
            [
                position = 7056, 8360
                rotation = left
                hide_name = True
            ]

            component "core/Sum" Sum19 {
                signs = "++"
            }
            [
                position = 8736, 8952
                hide_name = True
            ]

            component "core/Constant" Constant31 {
                execution_rate = "execution_rate"
                value = "execution_rate*Fs*2*np.pi"
            }
            [
                position = 8664, 8960
                hide_name = True
            ]

            component "core/Sum" Sum23 {
                signs = "++"
            }
            [
                position = 7944, 8584
                hide_name = True
            ]

            component "core/Limit" Limit1 {
                lower_limit = "-1000*vdc_set*0.05"
                upper_limit = "1000*vdc_set*0.05"
            }
            [
                position = 7632, 8624
                hide_name = True
            ]

            component "core/Limit" Limit2 {
                lower_limit = "-1000*vdc_set*0.05"
                upper_limit = "1000*vdc_set*0.05"
            }
            [
                position = 7616, 8944
                hide_name = True
            ]

            component "core/Sum" Sum24 {
                signs = "+"
            }
            [
                position = 7936, 8736
                hide_name = True
            ]

            component "core/Sum" Sum25 {
                signs = "++"
            }
            [
                position = 9304, 8704
                hide_name = True
            ]

            component "core/Sum" Sum26 {
                signs = "+-"
            }
            [
                position = 6912, 8528
                hide_name = True
            ]

            component "core/Constant" Constant38 {
                execution_rate = "execution_rate"
                value = "0"
            }
            [
                position = 6640, 8408
                hide_name = True
            ]

            component "core/Rate Limiter" "Rate Limiter1" {
                falling_limit = "-1*Sinv*Fs*1000"
                rising_limit = "1*Sinv*Fs*1000"
            }
            [
                position = 6848, 8472
                rotation = right
                hide_name = True
            ]

            component "core/Sum" Sum27 {
                signs = "+-"
            }
            [
                position = 6832, 8896
                hide_name = True
            ]

            component "core/Constant" Constant39 {
                execution_rate = "execution_rate"
                value = "0"
            }
            [
                position = 6560, 8800
                hide_name = True
            ]

            component "core/Rate Limiter" "Rate Limiter4" {
                falling_limit = "-1*Sinv*Fs*1000"
                rising_limit = "1*Sinv*Fs*1000"
            }
            [
                position = 6776, 8840
                rotation = right
                hide_name = True
            ]

            component "core/Signal Controlled Current Source" Isp1 {
            }
            [
                position = 7880, 9520
                rotation = right
                size = 64, 32
            ]

            component "core/C function" "C function3" {
                global_variables = "real ia_add;real ib_add;real ic_add;real ia_addn;real ib_addn;real ic_addn;real idcp;real idcn;real Emax;real Z;real VLL;real con_mode;"
                init_fnc = "/*Begin code section*/
Z = sqrt(Rac*Rac+Fs*Fs*4*Lac*Lac*9.8696);
/*End code section*/"
                input_terminals = "real Vdc;real Ea;inherit Eb;inherit Ec;inherit ia;inherit ib;inherit ic;inherit va;inherit vb;inherit vc;inherit mc;inherit con_en;"
                input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                input_terminals_feedthrough = "True;True;True;True;True;True;True;True;True;True;True;True"
                input_terminals_show_labels = "True;True;True;True;True;True;True;True;True;True;True;True"
                output_fnc = "/*Begin code section*/
Ea1 = Ea;
Eb1 = Eb;
Ec1 = Ec;
Emax = Ea-Eb;
VLL = va-vb;
con_mode = 1;
if ((vb-va)>VLL) {
    Emax = Eb-Ea;
    VLL = vb-va;
    con_mode = 2;
}
else if ((vb-vc)>VLL) {
    Emax = Eb-Ec;
    VLL = vb-vc;
    con_mode = 3;
}
else if ((vc-vb)>VLL) {
    Emax = Ec-Eb;
    VLL = vc-vb;
    con_mode = 4;
}
else if ((vc-va)>VLL) {
    Emax = Ec-Ea;
    VLL = vc-va;
    con_mode = 5;
}
else if ((va-vc)>VLL) {
    Emax = Ea-Ec;
    VLL = va-vc;
    con_mode = 6;
}



if (con_en==1) {
if (Vdc<VLL) {
    if (con_mode==1) {
        Ea1 = Vdc/2;
        Eb1 = -Vdc/2;
    }
    else if (con_mode==2) {
        Eb1 = Vdc/2;
        Ea1 = -Vdc/2;
    }
    else if (con_mode==3) {
        Eb1 = Vdc/2;
        Ec1 = -Vdc/2;
    }
    else if (con_mode==4) {
        Ec1 = Vdc/2;
        Eb1 = -Vdc/2;
    }
    else if (con_mode==5) {
        Ec1 = Vdc/2;
        Ea1 = -Vdc/2;
    }
    else if (con_mode==6) {
        Ea1 = Vdc/2;
        Ec1 = -Vdc/2;
    }

}
}







if (ia>=0) {
    if (Ea1>=0) {
        ia_add = -ia;
        ia_addn = 0;
    }
    else {
        ia_add = 0;
        ia_addn = ia;
    }
}
else {
    if (Ea1>=0) {
        ia_add = -ia;
        ia_addn = 0;
    }
    else {
        ia_add = 0;
        ia_addn = ia;
    }
}


if (ib>=0) {
    if (Eb1>=0) {
        ib_add = -ib;
        ib_addn = 0;
    }
    else {
        ib_add = 0;
        ib_addn = ib;
    }
}
else {
    if (Eb1>=0) {
        ib_add = -ib;
        ib_addn = 0;
    }
    else {
        ib_add = 0;
        ib_addn = ib;
    }
}


if (ic>=0) {
    if (Ec1>=0) {
        ic_add = -ic;
        ic_addn = 0;
    }
    else {
        ic_add = 0;
        ic_addn = ic;
    }
}
else {
    if (Ec1>=0) {
        ic_add = -ic;
        ic_addn = 0;
    }
    else {
        ic_add = 0;
        ic_addn = ic;
    }
}

idcp = mc*(ia_add + ib_add + ic_add);
idcn = mc*(ia_addn + ib_addn + ic_addn);

if (idcp>=0 && idcp>=idcn) {
    idc = idcp;
}
else if (idcp<0 && idcp>=idcn) {
    idc = idcn;
}
else if (idcp>=0 && idcp<idcn) {
    idc = idcn;
}
else if (idcp<0 && idcp<idcn) {
    idc = idcp;
}
else {
    idc = idcp;
}


if (Vdc<-2) {
    idc = -Vdc;
}
/*End code section*/"
                output_terminals = "real idc;real Ea1;real Eb1;real Ec1;"
                output_terminals_dimensions = "inherit;inherit;inherit;inherit"
                output_terminals_feedthrough = "True;True;True;True"
                output_terminals_show_labels = "True;True;True;True"
                parameters = "real Rac;real Lac;real Fs;"
            }
            [
                position = 9824, 8776
                hide_name = True
                size = 120, 392
            ]

            component "core/Voltage Measurement" Va1 {
                execution_rate = "execution_rate"
                sig_output = "True"
            }
            [
                position = 7976, 9512
                rotation = right
                size = 64, 32
            ]

            component "core/Probe" DC_C {
                signal_name = "V"
                signal_type = "current"
            }
            [
                position = 9920, 8560
                rotation = left
            ]

            component "core/Probe" DC_VDC {
                signal_name = "V"
                signal_type = "voltage"
            }
            [
                position = 8056, 9568
            ]

            component Subsystem Subsystem9 {
                layout = dynamic
                component "core/Product" Product5 {
                }
                [
                    position = 8080, 7888
                    hide_name = True
                ]

                component "core/Sum" Sum16 {
                }
                [
                    position = 8160, 7920
                    hide_name = True
                ]

                component "core/Mathematical function" "Mathematical function2" {
                    mathematical_fn = "sqrt"
                }
                [
                    position = 8264, 7920
                    hide_name = True
                ]

                component "core/Product" Product4 {
                }
                [
                    position = 8080, 7968
                    hide_name = True
                ]

                component "core/Trigonometric function" "Trigonometric function4" {
                    trigonometric_fn = "asin"
                }
                [
                    position = 8688, 8032
                    hide_name = True
                ]

                component "core/Product" Product7 {
                    signs = "*/"
                }
                [
                    position = 8512, 7872
                    hide_name = True
                ]

                component "core/Relational operator" "Relational operator2" {
                }
                [
                    position = 8344, 7992
                    hide_name = True
                ]

                component "core/Constant" Constant5 {
                    execution_rate = "execution_rate"
                    value = "0"
                }
                [
                    position = 8264, 8000
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch4" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 8768, 8016
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch12" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 8392, 8080
                    hide_name = True
                ]

                component "core/Sum" Sum19 {
                }
                [
                    position = 8232, 8072
                    hide_name = True
                ]

                component "core/Constant" Constant6 {
                    execution_rate = "execution_rate"
                    value = "0.001"
                }
                [
                    position = 8152, 8080
                    hide_name = True
                ]

                component "core/Constant" Constant7 {
                    execution_rate = "execution_rate"
                    value = "0"
                }
                [
                    position = 8608, 8000
                    hide_name = True
                ]

                component "core/Comparator" Comparator4 {
                }
                [
                    position = 8264, 8160
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch13" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 9000, 8208
                    hide_name = True
                ]

                component "core/Sum" Sum20 {
                    signs = "+-"
                }
                [
                    position = 8880, 8360
                    hide_name = True
                ]

                component "core/Constant" Constant8 {
                    execution_rate = "execution_rate"
                    value = "np.pi"
                }
                [
                    position = 8744, 8352
                    hide_name = True
                ]

                component "core/Comparator" Comparator5 {
                }
                [
                    position = 9008, 8312
                    hide_name = True
                ]

                component "core/Signal switch" "Signal switch14" {
                    criterion = "ctrl >= threshold"
                    threshold = "0.5"
                }
                [
                    position = 9072, 8360
                    hide_name = True
                ]

                component "core/Sum" Sum21 {
                    signs = "+-"
                }
                [
                    position = 8888, 8432
                    hide_name = True
                ]

                component "core/Constant" Constant9 {
                    execution_rate = "execution_rate"
                    value = "-np.pi"
                }
                [
                    position = 8744, 8424
                    hide_name = True
                ]

                component "core/Constant" Constant10 {
                    execution_rate = "execution_rate"
                    value = "0"
                }
                [
                    position = 8944, 8328
                    hide_name = True
                ]

                port mag {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8336, 7920
                ]

                port d {
                    position = left:2
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7776, 8304
                ]

                port q {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7696, 7872
                ]

                port Angle {
                    position = right:2
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9072, 8208
                ]

                junction Junction24 sp
                [
                    position = 8032, 7896
                ]

                junction Junction29 sp
                [
                    position = 8024, 7976
                ]

                junction Junction33 sp
                [
                    position = 7824, 8304
                ]

                junction Junction35 sp
                [
                    position = 8304, 7920
                ]

                junction Junction37 sp
                [
                    position = 8392, 7992
                ]

                junction Junction38 sp
                [
                    position = 8304, 7984
                ]

                junction Junction39 sp
                [
                    position = 8304, 8024
                ]

                junction Junction40 sp
                [
                    position = 8184, 8080
                ]

                junction Junction43 sp
                [
                    position = 8816, 8192
                ]

                junction Junction44 sp
                [
                    position = 8816, 8304
                ]

                junction Junction45 sp
                [
                    position = 8816, 8368
                ]

                junction Junction46 sp
                [
                    position = 7792, 7872
                ]

                connect Product4.in1 Junction29 as Connection222
                connect Product4.in Junction29 as Connection224
                connect Product4.out Sum16.in1 as Connection236
                connect Product5.in1 Junction24 as Connection228
                connect Product5.in Junction24 as Connection235
                connect Junction33 d as Connection238
                connect "Mathematical function2.in" Sum16.out as Connection234
                connect Sum16.in Product5.out as Connection231
                connect mag Junction35 as Connection252
                connect Junction35 "Mathematical function2.out" as Connection253
                [
                    position = 0, 0
                ]
                connect Constant5.out "Relational operator2.in1" as Connection255
                connect Junction33 Junction29 as Connection257
                [
                    position = 0, 0
                ]
                connect "Trigonometric function4.out" "Signal switch4.in1" as Connection262
                connect "Relational operator2.out" Junction37 as Connection263
                connect Junction37 "Signal switch4.in2" as Connection264
                [
                    position = 0, 0
                ]
                connect "Signal switch12.in2" Junction37 as Connection265
                connect Product7.out "Trigonometric function4.in" as Connection266
                connect "Relational operator2.in" Junction38 as Connection267
                connect Junction38 Junction35 as Connection268
                connect "Signal switch12.out" Product7.in1 as Connection270
                connect "Signal switch12.in1" Junction39 as Connection271
                connect Junction39 Junction38 as Connection272
                connect Sum19.in Junction39 as Connection273
                connect Sum19.out "Signal switch12.in" as Connection275
                connect Constant7.out "Signal switch4.in" as Connection276
                connect Constant6.out Junction40 as Connection277
                connect Junction40 Sum19.in1 as Connection278
                connect Comparator4.in2 Junction40 as Connection279
                connect Comparator4.out "Signal switch13.in2" as Connection283
                connect Junction43 "Signal switch13.in" as Connection290
                [
                    position = 0, 0
                ]
                connect Comparator5.out "Signal switch14.in2" as Connection292
                connect "Signal switch4.out" Junction43 as Connection294
                [
                    position = 0, 0
                ]
                connect Constant8.out Sum20.in as Connection295
                connect Comparator5.in1 Junction44 as Connection296
                connect Junction44 Junction43 as Connection297
                connect Constant9.out Sum21.in as Connection299
                connect Sum20.in1 Junction45 as Connection300
                connect Junction45 Junction44 as Connection301
                connect Sum21.in1 Junction45 as Connection302
                connect Sum20.out "Signal switch14.in" as Connection303
                connect Sum21.out "Signal switch14.in1" as Connection304
                connect Constant10.out Comparator5.in2 as Connection305
                connect "Signal switch14.out" "Signal switch13.in1" as Connection306
                connect Angle "Signal switch13.out" as Connection307
                connect Comparator4.in1 Junction33 as Connection312
                [
                    position = 0, 0
                ]
                connect Product7.in Junction46 as Connection314
                connect Junction46 Junction24 as Connection315
                [
                    position = 0, 0
                ]
                connect q Junction46 as Connection316
            }
            [
                position = 8064, 8672
                hide_name = True
                scale = 1, -1
                size = 48, 64
            ]

            component "core/Limit" Limit3 {
                lower_limit = "0.1"
                upper_limit = "1e9"
            }
            [
                position = 8168, 8776
                hide_name = True
            ]

            component "core/Product" Product12 {
                signs = "*/"
            }
            [
                position = 8296, 8720
                hide_name = True
            ]

            component "core/Limit" Limit4 {
                lower_limit = "0.1"
                upper_limit = "1e9"
            }
            [
                position = 8136, 8688
                hide_name = True
            ]

            component "core/Limit" Limit5 {
                lower_limit = "0"
                upper_limit = "1"
            }
            [
                position = 8376, 8720
                hide_name = True
            ]

            component "core/Product" Product13 {
            }
            [
                position = 8584, 8592
                hide_name = True
            ]

            component "core/Product" Product14 {
            }
            [
                position = 8600, 8792
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch18" {
                criterion = "ctrl >= threshold"
                    threshold = "0.5"
            }
            [
                position = 8672, 8576
                hide_name = True
                scale = 1, -1
            ]

            component "core/Signal switch" "Signal switch19" {
                criterion = "ctrl >= threshold"
                    threshold = "0.5"
            }
            [
                position = 8704, 8808
                hide_name = True
            ]

            component "core/Gain" Gain35 {
                gain = "0.6366"
            }
            [
                position = 8104, 8776
                hide_name = True
            ]

            component "core/Product" Product15 {
                signs = "*/"
            }
            [
                position = 8296, 8632
                hide_name = True
            ]

            component "core/Limit" Limit6 {
                lower_limit = "0"
                upper_limit = "1"
            }
            [
                position = 8376, 8632
                hide_name = True
            ]

            component "core/Constant" Constant43 {
                execution_rate = "execution_rate"
            }
            [
                position = 9688, 8952
                hide_name = True
            ]

            component "core/Probe" DC_m0 {
                signal_name = "V"
            }
            [
                position = 9736, 9056
                rotation = right
            ]

            component "core/Product" Product16 {
            }
            [
                position = 10296, 9008
                hide_name = True
            ]

            component "core/Probe" DC_Pow {
                signal_name = "V"
                signal_type = "active power"
            }
            [
                position = 10472, 9008
            ]

            component "core/Gain" Gain36 {
                gain = "0.001"
            }
            [
                position = 10376, 9008
                hide_name = True
            ]

            component "core/Constant" Constant44 {
                execution_rate = "execution_rate"
                value = "vdc_set"
            }
            [
                position = 6224, 8304
                hide_name = True
            ]

            component "core/Gain" Gain37 {
            }
            [
                position = 6288, 8472
                hide_name = True
            ]

            component "core/Gain" Gain38 {
                gain = "-1"
            }
            [
                position = 6968, 8600
                rotation = left
                hide_name = True
            ]

            component "core/Resistor" R_SN {
                resistance = "dc_snub"
            }
            [
                position = 7808, 9520
                rotation = right
            ]

            component "core/Gain" Gain39 {
                gain = "1000"
            }
            [
                position = 6824, 8960
                hide_name = True
            ]

            component "core/Gain" Gain40 {
                gain = "0.001"
            }
            [
                position = 6616, 8968
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch20" {
                criterion = "ctrl >= threshold"
                    threshold = "0.5"
            }
            [
                position = 8472, 8248
                hide_name = True
            ]

            component "core/Constant" Constant45 {
                execution_rate = "execution_rate"
                value = "0"
            }
            [
                position = 8392, 8232
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch21" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 9152, 8696
                hide_name = True
            ]

            component "core/Unit Delay" "Unit Delay1" {
            }
            [
                position = 9064, 8608
                rotation = down
                hide_name = True
            ]

            component "core/Termination" Termination100 {
            }
            [
                position = 9288, 9016
                rotation = right
                hide_name = True
            ]

            component "core/Termination" Termination101 {
            }
            [
                position = 7480, 8312
                rotation = right
                hide_name = True
            ]

            component "core/Termination" Termination102 {
            }
            [
                position = 8112, 8608
                rotation = left
                hide_name = True
            ]

            component "core/Capacitor" dccap {
                capacitance = "dc_cap"
                initial_voltage = "1000*vdc_set"
            }
            [
                position = 7712, 9520
                rotation = right
            ]

            component "core/Discrete Transfer Function" "Discrete Transfer Function1" {
                a_coeff = "[.001,1]"
                b_coeff = "[1]"
                domain = "S-domain"
                method = "Euler"
            }
            [
                position = 7832, 8408
                hide_name = True
            ]

            component "core/Sum" Sum28 {
                signs = "+-"
            }
            [
                position = 7744, 8408
                hide_name = True
            ]

            component "core/Constant" Constant47 {
                execution_rate = "execution_rate"
                value = "vac_set"
            }
            [
                position = 7592, 8440
                hide_name = True
            ]

            component "core/Sum" Sum29 {
                signs = "++"
            }
            [
                position = 7920, 8432
                hide_name = True
            ]

            component "core/Gain" Gain42 {
                gain = "1000/1.224745"
            }
            [
                position = 7664, 8440
                hide_name = True
            ]

            component "core/Signal switch" "Signal switch24" {
                criterion = "ctrl >= threshold"
                threshold = "0.5"
            }
            [
                position = 7848, 8536
                hide_name = True
            ]

            component "core/Open Circuit" "Open Circuit1" {
                circuit_connector = "true"
            }
            [
                position = 8128, 9760
                hide_name = True
            ]

            port A1 {
                position = 110.0, -32.0
                kind = pe
            }
            [
                position = 9224, 9424
                rotation = down
            ]

            port B1 {
                position = 110.0, 0.0
                kind = pe
            }
            [
                position = 9224, 9504
                rotation = down
            ]

            port C1 {
                position = 110.0, 32.0
                kind = pe
            }
            [
                position = 9224, 9584
                rotation = down
            ]

            port DC+ {
                label = "DC+"
                position = -110.0, -35.0
                kind = pe
            }
            [
                position = 7640, 9424
            ]

            port DC- {
                label = "DC-"
                position = -110.0, 35.0
                kind = pe
            }
            [
                position = 7640, 9608
            ]

            tag Goto5 {
                value = "P_out"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10568, 8792
                hide_name = True
                size = 60, 20
            ]

            tag Goto6 {
                value = "Q_out"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 10568, 8896
                hide_name = True
                size = 60, 20
            ]

            tag Goto7 {
                value = "V_en"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8312, 8296
                hide_name = True
                size = 60, 20
            ]

            tag Goto8 {
                value = "M_en"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8552, 8248
                hide_name = True
                size = 60, 20
            ]

            tag Goto9 {
                value = "ctrl_en"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8312, 8232
                hide_name = True
                size = 60, 20
            ]

            tag From4 {
                value = "Q_out"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6728, 8904
                hide_name = True
                size = 60, 20
            ]

            tag From5 {
                value = "ctrl_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6976, 8864
                hide_name = True
                size = 60, 20
            ]

            tag From6 {
                value = "V_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7096, 8896
                hide_name = True
                size = 60, 20
            ]

            tag From7 {
                value = "P_out"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6824, 8536
                hide_name = True
                size = 60, 20
            ]

            tag From8 {
                value = "ctrl_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7112, 8480
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag From9 {
                value = "M_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7200, 8488
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag Goto10 {
                value = "Watt"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6328, 8384
                hide_name = True
                size = 60, 20
            ]

            tag Goto11 {
                value = "VAR"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6328, 8424
                hide_name = True
                size = 60, 20
            ]

            tag From10 {
                value = "VAR"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6336, 8752
                hide_name = True
                size = 60, 20
            ]

            tag From11 {
                value = "Watt"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6480, 8352
                hide_name = True
                size = 60, 20
            ]

            tag Goto12 {
                value = "VLL"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6392, 8472
                hide_name = True
                size = 60, 20
            ]

            tag Goto13 {
                value = "Gen_V_mag"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7872, 8120
                hide_name = True
                size = 60, 20
            ]

            tag From14 {
                value = "Gen_V_mag"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6512, 8968
                hide_name = True
                size = 60, 20
            ]

            tag From15 {
                value = "VLL"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6280, 8928
                hide_name = True
                size = 60, 20
            ]

            tag Goto14 {
                value = "dED_sel"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7624, 9176
                hide_name = True
                size = 60, 20
            ]

            tag Goto15 {
                value = "dEQ_sel"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7624, 9200
                hide_name = True
                size = 60, 20
            ]

            tag From16 {
                value = "dED_sel"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6872, 8848
                hide_name = True
                size = 60, 20
            ]

            tag From17 {
                value = "dEQ_sel"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7336, 8456
                hide_name = True
                size = 60, 20
            ]

            tag From18 {
                value = "dED_sel"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7320, 8832
                hide_name = True
                size = 60, 20
            ]

            tag From19 {
                value = "dED_sel"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7320, 8952
                hide_name = True
                size = 60, 20
            ]

            tag Goto16 {
                value = "fs"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6328, 8344
                hide_name = True
                size = 60, 20
            ]

            tag From20 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6832, 8680
                hide_name = True
                size = 60, 20
            ]

            tag From22 {
                value = "vdc_ref"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6528, 8664
                hide_name = True
                size = 60, 20
            ]

            tag From23 {
                value = "dEQ_sel"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7328, 8576
                hide_name = True
                size = 60, 20
            ]

            tag From24 {
                value = "dEQ_sel"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6984, 8488
                hide_name = True
                size = 60, 20
            ]

            tag Goto19 {
                value = "mod_internal"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6784, 9200
                hide_name = True
                size = 83, 20
            ]

            tag From25 {
                value = "mod_internal"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6936, 9200
                hide_name = True
                size = 95, 20
            ]

            tag Goto20 {
                value = "I_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8872, 9392
                hide_name = True
                size = 60, 20
            ]

            tag Goto21 {
                value = "I_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8872, 9472
                hide_name = True
                size = 60, 20
            ]

            tag Goto22 {
                value = "I_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8872, 9552
                hide_name = True
                size = 60, 20
            ]

            tag Goto23 {
                value = "V_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8992, 9624
                rotation = left
                hide_name = True
                size = 60, 20
            ]

            tag Goto24 {
                value = "V_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9072, 9624
                rotation = left
                hide_name = True
                size = 60, 20
            ]

            tag Goto25 {
                value = "V_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9152, 9624
                rotation = left
                hide_name = True
                size = 60, 20
            ]

            tag From26 {
                value = "E_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8464
                hide_name = True
                size = 60, 20
            ]

            tag From27 {
                value = "E_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8496
                hide_name = True
                size = 60, 20
            ]

            tag From28 {
                value = "V_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8576
                hide_name = True
                size = 60, 20
            ]

            tag From29 {
                value = "V_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8600
                hide_name = True
                size = 60, 20
            ]

            tag From30 {
                value = "V_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8680
                hide_name = True
                size = 60, 20
            ]

            tag From31 {
                value = "V_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8704
                hide_name = True
                size = 60, 20
            ]

            tag From32 {
                value = "V_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7344, 8176
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag From33 {
                value = "V_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7320, 8176
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag From34 {
                value = "V_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7296, 8176
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag From35 {
                value = "I_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9176, 8848
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag From36 {
                value = "I_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9152, 8848
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag From37 {
                value = "I_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9128, 8848
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag Goto26 {
                value = "V_mag"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7696, 8136
                hide_name = True
                size = 60, 20
            ]

            tag Goto27 {
                value = "V_ang"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7696, 8104
                hide_name = True
                size = 60, 20
            ]

            tag From38 {
                value = "wst"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9104, 8848
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag Goto28 {
                value = "I_d"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9328, 8912
                hide_name = True
                size = 60, 20
            ]

            tag Goto29 {
                value = "I_q"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9328, 8936
                hide_name = True
                size = 60, 20
            ]

            tag Goto30 {
                value = "E_a"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8920, 8792
                hide_name = True
                size = 60, 20
            ]

            tag Goto31 {
                value = "E_b"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8920, 8816
                hide_name = True
                size = 60, 20
            ]

            tag Goto32 {
                value = "E_c"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8920, 8840
                hide_name = True
                size = 60, 20
            ]

            tag From41 {
                value = "E_a1"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8224, 9568
                hide_name = True
                size = 60, 20
            ]

            tag From42 {
                value = "E_b1"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8224, 9632
                hide_name = True
                size = 60, 20
            ]

            tag From43 {
                value = "E_c1"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8224, 9704
                hide_name = True
                size = 60, 20
            ]

            tag From44 {
                value = "fs"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 6672, 8248
                hide_name = True
                size = 60, 20
            ]

            tag From45 {
                value = "I_d"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8800
                hide_name = True
                size = 60, 20
            ]

            tag From46 {
                value = "V_mag"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8776
                hide_name = True
                size = 60, 20
            ]

            tag From47 {
                value = "V_mag"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8880
                hide_name = True
                size = 60, 20
            ]

            tag From48 {
                value = "I_q"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8904
                hide_name = True
                size = 60, 20
            ]

            tag Goto33 {
                value = "dEq"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7712, 8624
                hide_name = True
                size = 60, 20
            ]

            tag From49 {
                value = "dEq"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7840, 8736
                hide_name = True
                size = 60, 20
            ]

            tag Goto34 {
                value = "dEd"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7704, 8944
                hide_name = True
                size = 60, 20
            ]

            tag From50 {
                value = "dEd"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7848, 8592
                hide_name = True
                size = 60, 20
            ]

            tag Goto39 {
                value = "wt"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7368, 8312
                hide_name = True
                size = 60, 20
            ]

            tag From59 {
                value = "wst"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8624, 8912
                hide_name = True
                size = 60, 20
            ]

            tag From60 {
                value = "V_ang"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9072, 8712
                hide_name = True
                size = 60, 20
            ]

            tag From61 {
                value = "wt"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9216, 8728
                hide_name = True
                size = 60, 20
            ]

            tag Goto40 {
                value = "wst"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9392, 8704
                hide_name = True
                size = 60, 20
            ]

            tag Goto41 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8072, 9488
                hide_name = True
                size = 60, 20
            ]

            tag From63 {
                value = "I_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8728
                hide_name = True
                size = 60, 20
            ]

            tag From64 {
                value = "I_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8760
                hide_name = True
                size = 60, 20
            ]

            tag From65 {
                value = "I_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8792
                hide_name = True
                size = 60, 20
            ]

            tag From66 {
                value = "E_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8632
                hide_name = True
                size = 60, 20
            ]

            tag From67 {
                value = "E_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8664
                hide_name = True
                size = 60, 20
            ]

            tag From68 {
                value = "E_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8696
                hide_name = True
                size = 60, 20
            ]

            tag Goto42 {
                value = "idc"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9976, 8608
                hide_name = True
                size = 60, 20
            ]

            tag From69 {
                value = "idc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7912, 9464
                rotation = right
                hide_name = True
                size = 60, 20
            ]

            tag From70 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8600
                hide_name = True
                size = 60, 20
            ]

            tag From71 {
                value = "V_a"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8824
                hide_name = True
                size = 60, 20
            ]

            tag From72 {
                value = "V_b"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8856
                hide_name = True
                size = 58, 20
            ]

            tag From73 {
                value = "V_c"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8888
                hide_name = True
                size = 60, 20
            ]

            tag From74 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8024, 8776
                hide_name = True
                size = 60, 20
            ]

            tag From75 {
                value = "ctrl_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8624, 8640
                hide_name = True
                size = 60, 20
            ]

            tag From76 {
                value = "ctrl_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8656, 8744
                hide_name = True
                size = 60, 20
            ]

            tag Goto43 {
                value = "mc"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8464, 8632
                hide_name = True
                size = 60, 20
            ]

            tag From77 {
                value = "mc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8920
                hide_name = True
                size = 60, 20
            ]

            tag Goto44 {
                value = "E_a1"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9976, 8720
                hide_name = True
                size = 60, 20
            ]

            tag Goto45 {
                value = "E_b1"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9976, 8832
                hide_name = True
                size = 60, 20
            ]

            tag Goto46 {
                value = "E_c1"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 9976, 8944
                hide_name = True
                size = 60, 20
            ]

            tag From78 {
                value = "ctrl_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9608, 8952
                hide_name = True
                size = 60, 20
            ]

            tag From79 {
                value = "idc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 8992
                hide_name = True
                size = 60, 20
            ]

            tag From80 {
                value = "Vdc"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 10200, 9016
                hide_name = True
                size = 60, 20
            ]

            tag Goto47 {
                value = "vdc_ref"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 6328, 8304
                hide_name = True
                size = 60, 20
            ]

            tag Goto48 {
                value = "GF_en"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7624, 9224
                hide_name = True
                size = 58, 20
            ]

            tag From81 {
                value = "GF_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8408, 8200
                hide_name = True
                size = 60, 20
            ]

            tag From82 {
                value = "GF_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 9088, 8648
                hide_name = True
                size = 60, 20
            ]

            tag From39 {
                value = "V_mag"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7600, 8400
                hide_name = True
                size = 60, 20
            ]

            tag From85 {
                value = "GF_en"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7648, 8488
                hide_name = True
                size = 60, 20
            ]

            junction Junction13 sp
            [
                position = 6984, 9016
            ]

            junction Junction15 sp
            [
                position = 7080, 8608
            ]

            junction Junction23 sp
            [
                position = 7808, 8120
            ]

            junction Junction29 sp
            [
                position = 7216, 8904
            ]

            junction Junction33 sp
            [
                position = 7248, 8528
            ]

            junction Junction34 sp
            [
                position = 7248, 8616
            ]

            junction Junction35 pe
            [
                position = 8376, 9760
            ]

            junction Junction39 pe
            [
                position = 8960, 9424
            ]

            junction Junction40 pe
            [
                position = 9040, 9504
            ]

            junction Junction41 pe
            [
                position = 9120, 9584
            ]

            junction Junction47 sp
            [
                position = 8264, 8264
            ]

            junction Junction50 sp
            [
                position = 7640, 8120
            ]

            junction Junction68 sp
            [
                position = 7320, 8272
            ]

            junction Junction72 sp
            [
                position = 7248, 8576
            ]

            junction Junction88 sp
            [
                position = 7216, 8944
            ]

            junction Junction89 sp
            [
                position = 7216, 8992
            ]

            junction Junction94 pe
            [
                position = 7880, 9608
            ]

            junction Junction95 pe
            [
                position = 7880, 9424
            ]

            junction Junction97 sp
            [
                position = 9920, 8608
            ]

            junction Junction98 sp
            [
                position = 8016, 9512
            ]

            junction Junction99 sp
            [
                position = 8512, 8720
            ]

            junction Junction100 sp
            [
                position = 8000, 8584
            ]

            junction Junction103 sp
            [
                position = 8528, 8584
            ]

            junction Junction104 sp
            [
                position = 7976, 8736
            ]

            junction Junction105 sp
            [
                position = 8536, 8800
            ]

            junction Junction106 sp
            [
                position = 8208, 8712
            ]

            junction Junction107 sp
            [
                position = 8184, 8688
            ]

            junction Junction108 sp
            [
                position = 9736, 8920
            ]

            junction Junction110 pe
            [
                position = 7808, 9424
            ]

            junction Junction111 pe
            [
                position = 7808, 9608
            ]

            junction Junction113 sp
            [
                position = 9200, 8696
            ]

            junction Junction114 sp
            [
                position = 10496, 8792
            ]

            junction Junction115 sp
            [
                position = 10496, 8896
            ]

            junction Junction116 pe
            [
                position = 9040, 9760
            ]

            junction Junction117 pe
            [
                position = 8960, 9760
            ]

            junction Junction118 pe
            [
                position = 8448, 9760
            ]

            junction Junction119 sp
            [
                position = 8264, 8264
            ]

            junction Junction120 pe
            [
                position = 7712, 9608
            ]

            junction Junction121 pe
            [
                position = 7712, 9424
            ]

            junction Junction126 sp
            [
                position = 7704, 8440
            ]

            junction Junction127 sp
            [
                position = 7696, 8400
            ]

            junction Junction128 pe
            [
                position = 8304, 9760
            ]

            junction Junction129 pe
            [
                position = 7976, 9608
            ]

            connect Integrator3.out Sum8.in1 as Connection136
            connect From5 "Signal switch3.in2" as Connection142
            connect Junction13 "Signal switch3.in1" as Connection146
            connect "Signal switch4.in1" Junction13 as Connection147
            connect From6 "Signal switch4.in2" as Connection148
            connect Integrator4.out Sum10.in1 as Connection158
            connect From8 "Signal switch5.in2" as Connection160
            connect "Signal switch5.out" "Signal switch6.in" as Connection161
            connect Constant5.out Junction15 as Connection162
            connect Junction15 "Signal switch5.in1" as Connection163
            connect "Signal switch6.in1" Junction15 as Connection164
            connect From9 "Signal switch6.in2" as Connection165
            connect V_gen.in Junction23 as Connection251
            connect Junction23 Gain23.out as Connection252
            connect Gain24.out "Signal switch13.in" as Connection282
            connect Gain25.out "Signal switch13.in1" as Connection283
            connect Gain24.in Junction29 as Connection287
            connect "Signal switch13.out" Sum8.in as Connection290
            connect Gain26.out "Signal switch14.in" as Connection292
            connect Gain27.out "Signal switch14.in1" as Connection293
            connect "Signal switch14.out" Integrator3.in as Connection300
            connect "C function1.dED_sel" Goto14 as Connection309
            connect Constant9.out "C function1.mode_external" as Connection315
            connect Constant13.out "C function1.Mode_select_int" as Connection316
            connect From18 "Signal switch13.in2" as Connection318
            connect From19 "Signal switch14.in2" as Connection319
            connect From20 Sum14.in1 as Connection323
            connect From17 "Signal switch15.in2" as Connection329
            connect Gain28.out "Signal switch15.in1" as Connection331
            connect Gain14.in Junction33 as Connection332
            connect Gain28.in Junction33 as Connection334
            connect Gain29.out "Signal switch16.in1" as Connection335
            connect From23 "Signal switch16.in2" as Connection336
            connect Junction34 Gain13.in as Connection341
            connect Gain29.in Junction34 as Connection342
            connect "Signal switch17.out" "Signal switch5.in" as Connection349
            connect Gain32.out "C function1.Mode_select_ext" as Connection368
            connect Constant14.out Goto19 as Connection374
            connect Junction13 Constant4.out as Connection382
            connect "Signal switch3.in" "Signal switch12.out" as Connection381
            connect Gain14.out "Signal switch15.in" as Connection393
            connect "Signal switch15.out" Sum10.in as Connection394
            connect "Signal switch16.in" Gain13.out as Connection395
            connect "Signal switch16.out" Integrator4.in as Connection396
            connect "C function1.dEQ_sel" Goto15 as Connection399
            connect Junction35 Vinv_b.n_node as Connection419
            connect Vinv_a.p_node Ra.p_node as Connection421
            connect Vinv_b.p_node Rb.p_node as Connection422
            connect Vinv_c.p_node Rc.p_node as Connection423
            connect Ra.n_node La.p_node as Connection424
            connect Rb.n_node Lb.p_node as Connection425
            connect Rc.n_node Lc.p_node as Connection426
            connect La.n_node Ia.p_node as Connection427
            connect Lb.n_node Ib.p_node as Connection428
            connect Lc.n_node Ic.p_node as Connection429
            connect Goto20 Ia.out as Connection439
            connect Ia.n_node Junction39 as Connection443
            connect Junction39 A1 as Connection444
            connect Va.p_node Junction39 as Connection445
            connect Ib.n_node Junction40 as Connection446
            connect Junction40 B1 as Connection447
            connect Vb.p_node Junction40 as Connection448
            connect Ic.n_node Junction41 as Connection449
            connect Junction41 C1 as Connection450
            connect Vc.p_node Junction41 as Connection451
            connect Goto21 Ib.out as Connection452
            connect Goto22 Ic.out as Connection453
            connect Goto23 Va.out as Connection454
            connect Goto24 Vb.out as Connection455
            connect Goto25 Vc.out as Connection456
            connect From26 Sum15.in as Connection457
            connect From27 Sum15.in1 as Connection458
            connect From28 Sum16.in as Connection459
            connect From29 Sum16.in1 as Connection460
            connect From30 Sum17.in as Connection461
            connect From31 Sum17.in1 as Connection462
            connect Sum15.out Vab.in as Connection463
            connect Sum16.out Vbc.in as Connection464
            connect Sum17.out Vca.in as Connection465
            connect From35 "abc to dq2.va" as Connection469
            connect From36 "abc to dq2.vb" as Connection470
            connect From37 "abc to dq2.vc" as Connection471
            connect Goto13 Junction23 as Connection475
            connect Subsystem8.Angle Goto27 as Connection485
            connect From38 "abc to dq2.wt" as Connection489
            connect Constant21.out Comparator1.in2 as Connection4875
            connect Goto9 Junction47 as Connection5040
            connect Junction47 Comparator1.out as Connection5041
            connect Constant24.out Goto16 as Connection5048
            connect "dq to abc1.phase_a" Goto30 as Connection5054
            connect "dq to abc1.phase_b" Goto31 as Connection5055
            connect "dq to abc1.phase_c" Goto32 as Connection5056
            connect Subsystem8.mag Junction50 as Connection5073
            connect Junction50 Goto26 as Connection5074
            connect Gain23.in Junction50 as Connection5075
            connect From46 Product1.in as Connection5080
            connect From45 Product1.in1 as Connection5081
            connect Product1.out Gain9.in as Connection5082
            connect Product4.out Gain10.in as Connection5085
            connect From47 Product4.in as Connection5090
            connect From48 Product4.in1 as Connection5091
            connect Gain33.out "C function2.in" as Connection5103
            connect Constant28.out "C function2.reset_level" as Connection5105
            connect Constant31.out Sum19.in1 as Connection5122
            connect Subsystem8.d "abc to dq1.d_axis" as Connection5189
            connect Subsystem8.q "abc to dq1.q_axis" as Connection5190
            connect From50 Sum23.in1 as Connection5199
            connect Limit2.out Goto34 as Connection5206
            connect From49 Sum24.in as Connection5216
            connect Constant30.out "C function2.dt" as Connection5238
            connect Goto39 Junction68 as Connection5241
            connect Junction68 "C function2.out" as Connection5242
            connect "abc to dq1.wt" Junction68 as Connection5243
            connect From61 Sum25.in1 as Connection5245
            connect Sum10.out Limit1.in as Connection5263
            connect From7 Sum26.in1 as Connection5272
            connect Constant38.out Sum9.in1 as Connection5273
            connect Sum26.out "Signal switch17.in" as Connection5274
            connect Junction33 Junction72 as Connection5277
            connect Junction72 Junction34 as Connection5278
            connect "Signal switch6.out" Junction72 as Connection5279
            connect "Rate Limiter1.out" Sum26.in as Connection5281
            connect Sum27.out "Signal switch12.in" as Connection5286
            connect From4 Sum27.in1 as Connection5287
            connect Constant39.out Sum7.in1 as Connection5288
            connect Sum27.in "Rate Limiter4.out" as Connection5289
            connect "Rate Limiter4.in" Sum7.out as Connection5290
            connect "Signal switch3.out" "Signal switch4.in" as Connection5291
            connect Goto29 "abc to dq2.q_axis" as Connection5334
            connect "abc to dq2.d_axis" Goto28 as Connection5335
            connect Sum19.out "dq to abc1.wt" as Connection5347
            connect "Signal switch4.out" Junction88 as Connection5361
            connect Junction88 Junction29 as Connection5362
            connect Gain26.in Junction89 as Connection5364
            connect Junction89 Junction88 as Connection5365
            connect Gain27.in Junction89 as Connection5366
            connect Isp1.n_node Junction94 as Connection5381
            connect Isp1.p_node Junction95 as Connection5384
            connect Va1.p_node Junction95 as Connection5386
            connect From67 "C function3.Eb" as Connection5390
            connect From68 "C function3.Ec" as Connection5391
            connect From63 "C function3.ia" as Connection5392
            connect From64 "C function3.ib" as Connection5393
            connect From65 "C function3.ic" as Connection5394
            connect "C function3.idc" Junction97 as Connection5400
            connect Junction97 DC_C.in as Connection5401
            connect Goto42 Junction97 as Connection5402
            connect From69 Isp1.in as Connection5403
            connect "C function3.Ea" From66 as Connection5404
            connect Goto41 Junction98 as Connection5405
            connect Junction98 Va1.out as Connection5406
            connect DC_VDC.in Junction98 as Connection5407
            connect From70 "C function3.Vdc" as Connection5408
            connect From71 "C function3.va" as Connection5409
            connect From72 "C function3.vb" as Connection5410
            connect From73 "C function3.vc" as Connection5411
            connect Gain25.in Junction29 as Connection5416
            connect Constant27.out "dq to abc1.zero_input" as Connection5419
            connect Clock1.out Comparator1.in1 as Connection5421
            connect From59 Sum19.in as Connection5422
            connect Subsystem9.mag Limit4.in as Connection5432
            connect Product12.out Limit5.in as Connection5435
            connect Junction99 Limit5.out as Connection5446
            connect Product14.in Junction99 as Connection5447
            connect Sum23.out Junction100 as Connection5448
            connect Subsystem9.d Junction100 as Connection5450
            connect Junction100 Junction103 as Connection5459
            connect Junction103 Product13.in as Connection5460
            connect "Signal switch18.in1" Junction103 as Connection5461
            connect "Signal switch18.in" Product13.out as Connection5462
            connect "Signal switch18.out" "dq to abc1.d_input" as Connection5463
            connect Product14.out "Signal switch19.in" as Connection5466
            connect Subsystem9.q Junction104 as Connection5467
            connect Junction104 Sum24.out as Connection5468
            connect Product14.in1 Junction105 as Connection5470
            connect Junction105 Junction104 as Connection5471
            connect "Signal switch19.in1" Junction105 as Connection5472
            connect "Signal switch19.out" "dq to abc1.q_input" as Connection5473
            connect From74 Gain35.in as Connection5474
            connect Gain35.out Limit3.in as Connection5475
            connect Product13.in1 Junction99 as Connection5481
            connect Limit3.out Junction106 as Connection5482
            connect Junction106 Product12.in as Connection5483
            connect Product15.in1 Junction106 as Connection5484
            connect Product12.in1 Junction107 as Connection5485
            connect Junction107 Limit4.out as Connection5486
            connect Product15.in Junction107 as Connection5487
            connect Product15.out Limit6.in as Connection5488
            connect Limit6.out Goto43 as Connection5489
            connect From76 "Signal switch19.in2" as Connection5491
            connect From75 "Signal switch18.in2" as Connection5492
            connect "C function3.Ea1" Goto44 as Connection5493
            connect "C function3.Eb1" Goto45 as Connection5494
            connect "C function3.Ec1" Goto46 as Connection5495
            connect From77 Junction108 as Connection5500
            connect Junction108 "C function3.mc" as Connection5501
            connect DC_m0.in Junction108 as Connection5502
            connect Constant43.out "C function3.con_en" as Connection5503
            connect From79 Product16.in as Connection5504
            connect From80 Product16.in1 as Connection5505
            connect Product16.out Gain36.in as Connection5506
            connect Gain36.out DC_Pow.in as Connection5507
            connect Gain30.out Sum14.in as Connection5508
            connect Constant44.out Goto47 as Connection5509
            connect Constant25.out Gain37.in as Connection5510
            connect Gain37.out Goto12 as Connection5511
            connect "abc to dq1.va" From32 as Connection5513
            connect From33 "abc to dq1.vb" as Connection5515
            connect Sum25.out Goto40 as Connection5512
            connect "abc to dq1.vc" From34 as Connection5514
            connect Sum14.out Gain38.in as Connection5522
            connect From16 "Signal switch12.in2" as Connection5530
            connect From24 "Signal switch17.in2" as Connection5531
            connect Junction110 Junction95 as Connection5536
            connect R_SN.p_node Junction110 as Connection5537
            connect Junction111 Junction94 as Connection5539
            connect R_SN.n_node Junction111 as Connection5540
            connect Gain38.out "Signal switch17.in1" as Connection5541
            connect Constant3.out "C function2.ang_init" as Connection5542
            connect Sum11.out Gain39.in as Connection5543
            connect Gain39.out "Signal switch12.in1" as Connection5544
            connect From14 Gain40.in as Connection5545
            connect Gain40.out Sum11.in1 as Connection5546
            connect "C function1.GF_en" Goto48 as Connection5547
            connect From81 "Signal switch20.in2" as Connection5548
            connect "Signal switch20.out" Goto8 as Connection5550
            connect Constant45.out "Signal switch20.in" as Connection5554
            connect From82 "Signal switch21.in2" as Connection5563
            connect From60 "Signal switch21.in1" as Connection5565
            connect "Unit Delay1.out" "Signal switch21.in" as Connection5566
            connect "Signal switch21.out" Junction113 as Connection5567
            connect Junction113 Sum25.in as Connection5568
            connect "Unit Delay1.in" Junction113 as Connection5569
            connect Limit2.in Sum8.out as Connection5570
            connect Limit1.out Goto33 as Connection5571
            connect Vinv_b.in From42 as Connection5574
            connect Vinv_a.in From41 as Connection5573
            connect Vinv_c.in From43 as Connection5572
            connect "abc to dq2.zero_axis" Termination100.in as Connection5577
            connect Termination101.in "abc to dq1.zero_axis" as Connection5578
            connect Termination102.in Subsystem9.Angle as Connection5579
            connect Gain21.in Gain9.out as Connection5582
            [
                position = 0, 0
            ]
            connect P_gen.in Junction114 as Connection5583
            connect Junction114 Gain21.out as Connection5584
            connect Goto5 Junction114 as Connection5585
            connect Gain10.out Gain22.in as Connection5586
            [
                position = 0, 0
            ]
            connect Gain22.out Junction115 as Connection5587
            connect Junction115 Q_gen.in as Connection5588
            connect Goto6 Junction115 as Connection5589
            connect Vc.n_node Junction116 as Connection5597
            connect Junction116 Vb.n_node as Connection5598
            connect Va.n_node Junction117 as Connection5600
            connect Junction117 Junction116 as Connection5601
            connect Vinv_c.n_node Junction118 as Connection5602
            connect Junction118 Junction35 as Connection5603
            connect Junction117 Junction118 as Connection5604
            connect Sum9.out "Rate Limiter1.in" as Connection5605
            connect Junction47 Junction119 as Connection5607
            connect Junction119 Goto7 as Connection5608
            [
                position = 0, 0
            ]
            connect "Signal switch20.in1" Junction119 as Connection5609
            connect DC- Junction120 as Connection5610
            connect Junction120 Junction111 as Connection5611
            connect DC+ Junction121 as Connection5612
            [
                position = 0, 0
            ]
            connect Junction121 Junction110 as Connection5613
            [
                position = 0, 0
            ]
            connect dccap.p_node Junction121 as dcConnp
            connect dccap.n_node Junction120 as dcConnn
            connect "Discrete Transfer Function1.out" Sum29.in as Connection5644
            connect "Discrete Transfer Function1.in" Sum28.out as Connection5645
            connect Junction126 Sum28.in1 as Connection5647
            connect Sum29.in1 Junction126 as Connection5648
            connect Constant47.out Gain42.in as Connection5650
            connect Gain42.out Junction126 as Connection5651
            connect From85 "Signal switch24.in2" as Connection5652
            connect "Signal switch24.in" Sum29.out as Connection5653
            connect From39 Junction127 as Connection5654
            connect Junction127 Sum28.in as Connection5655
            connect "Signal switch24.in1" Junction127 as Connection5656
            connect "Signal switch24.out" Sum23.in as Connection5657
            connect Gain32.in From25 as connmode
            connect Sum9.in From11 as connP
            connect Sum7.in From10 as connQ
            connect Sum11.in From15 as connV
            connect Gain30.in From22 as connw
            connect Gain33.in From44 as connfs
            connect Constant22.out Goto10 as connPint
            connect Constant23.out Goto11 as Connection5658
            connect Junction35 Junction128 as Connection5659
            connect Junction128 Vinv_a.n_node as Connection5660
            connect "Open Circuit1.n_node" Junction128 as Connection5661
            connect Va1.n_node Junction129 as Connection5662
            connect Junction129 Junction94 as Connection5663
            connect "Open Circuit1.p_node" Junction129 as Connection5664

            loadshape_int = "1"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Voltage Source Converter</p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">This component provides an average model of a three-phase full bridge DC to AC converter.</p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Internal PI controllers (with adjustable gains) are used to implement multiple modes of steady state operations. Note that this component will be converted to a conventional generator mode with only PQ and PV modes when simulated in OpenDSS.</p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">When external control mode is selected, the operation mode can be selected and changed in real time using the following inputs to \"Inverter control mode\" input:</p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">0 = PV operation mode</p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">1 = PQ operation mode</p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">2 = Vdc-Vac operation mode</p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">3 = Vdc-Q operation mode</p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">4 = Grid forming operation mode</p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Active power P (in kilo Watts), Reactive power Q (In kilo VARs), Line RMS voltage (in Kilo-Volts), DC-Link voltage (in Kilo-Volts) and Line frequency (in Hz) can be controlled individually depending on mode of operation. Controller coefficients for above variables can be set in \"Controller settings\" tab.</p></body></html>"

                ctrl_mode_str {
                    label = "Inverter control mode"
                    widget = combo
                    combo_values = "PQ", "PV", "Vdc-Vac", "Vdc-Q", "Grid Forming", "External Control"
                    type = string
                    default_value = "PQ"
                    group = "Control mode:2"
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.set_control_mode(mdl, container_handle, new_value)
                        comp_script.inv_control_mode_value_edited(mdl, container_handle, new_value)
                    ENDCODE

                    CODE property_value_edited
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.inv_control_mode_value_edited(mdl, container_handle, new_value)
                    ENDCODE
                }

                ctrl_mode_int {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                ext_mode {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                P_ref_str {
                    label = "Active power reference (kW)"
                    widget = combo
                    combo_values = "External input", "Converter nominal"
                    type = string
                    default_value = "Converter nominal"
                    group = "Control mode"
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.set_external_input(mdl, container_handle, prop_handle, new_value)
                    ENDCODE
                }

                P_sel {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                Q_ref_str {
                    label = "Reactive power reference (kVAR)"
                    widget = combo
                    combo_values = "External input", "Converter nominal"
                    type = string
                    default_value = "Converter nominal"
                    group = "Control mode"
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.set_external_input(mdl, container_handle, prop_handle, new_value)
                    ENDCODE
                }

                Q_sel {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                V_ref_str {
                    label = "Line voltage reference (kV)"
                    widget = combo
                    combo_values = "External input", "Converter nominal"
                    type = string
                    default_value = "Converter nominal"
                    group = "Control mode"
                    disabled
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.set_external_input(mdl, container_handle, prop_handle, new_value)
                    ENDCODE
                }

                V_sel {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                vdc_ref_str {
                    label = "DC Link voltage (kV)"
                    widget = combo
                    combo_values = "External input", "Converter nominal"
                    type = string
                    default_value = "Converter nominal"
                    group = "Control mode"
                    disabled
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.set_external_input(mdl, container_handle, prop_handle, new_value)
                    ENDCODE
                }

                fs_ref_str {
                    label = "Frequency (Hz)"
                    widget = combo
                    combo_values = "External input", "Converter nominal"
                    type = string
                    default_value = "Converter nominal"
                    group = "Control mode"
                    disabled
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.set_external_input(mdl, container_handle, prop_handle, new_value)
                    ENDCODE
                }

                w_sel {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                P_kp {
                    label = "P Controller proportional gain"
                    widget = edit
                    type = generic
                    default_value = "2e-3"
                    group = "Controller settings:3"
                }

                P_ki {
                    label = "P Controller integral gain"
                    widget = edit
                    type = generic
                    default_value = "0.2"
                    group = "Controller settings"
                }

                Q_kp {
                    label = "Q Controller proportional gain"
                    widget = edit
                    type = generic
                    default_value = "2e-3"
                    group = "Controller settings"
                }

                Q_ki {
                    label = "Q Controller integral gain"
                    widget = edit
                    type = generic
                    default_value = "0.05"
                    group = "Controller settings"
                }

                V_kp {
                    label = "V Controller proportional gain"
                    widget = edit
                    type = generic
                    default_value = "1e-6"
                    group = "Controller settings"
                    disabled
                }

                V_ki {
                    label = "V Controller integral gain"
                    widget = edit
                    type = generic
                    default_value = "50"
                    group = "Controller settings"
                    disabled
                }

                vdc_kp {
                    label = "DC-Link Voltage Controller proportional gain"
                    widget = edit
                    type = generic
                    default_value = "1000e-6"
                    group = "Controller settings"
                    disabled
                }

                vdc_ki {
                    label = "DC-Link Voltage Controller integral gain"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "Controller settings"
                    disabled
                }

                vdc_set {
                    label = "Inverter DC-Link Voltage"
                    widget = edit
                    type = generic
                    default_value = "2.5"
                    unit = "kV"
                    group = "Inverter Parameters:1"
                }

                dc_cap_en {
                    label = "Use Internal DC-Link Capacitor"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "Inverter Parameters"
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.place_internal_dc_capacitor(mdl, container_handle, new_value)

                        comp_script.dc_link_cap_value_edited(mdl, container_handle, new_value)
                    ENDCODE

                    CODE property_value_edited
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.dc_link_cap_value_edited(mdl, container_handle, new_value)
                    ENDCODE
                }

                dc_cap {
                    label = "Internal DC-Link Capacitor"
                    widget = edit
                    type = generic
                    default_value = "1e-2"
                    unit = "F"
                    group = "Inverter Parameters"
                }

                dc_snub {
                    label = "DC-Link Snubber Resistance"
                    widget = edit
                    type = generic
                    default_value = "500"
                    unit = "Ω"
                    group = "Inverter Parameters"
                }

                vac_set {
                    label = "Nominal AC Line voltage"
                    widget = edit
                    type = generic
                    default_value = "1.73"
                    unit = "kV"
                    group = "Inverter Parameters"
                }

                global_basefreq {
                    label = "Global base frequency"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "Inverter Parameters"
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        if old_value == new_value:
                            comp_script.update_frequency_property(mdl, container_handle, init=True)
                        else:
                            comp_script.update_frequency_property(mdl, container_handle)
                    ENDCODE

                    CODE property_value_edited
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.toggle_frequency_prop(mdl, container_handle)
                    ENDCODE
                }

                Fs {
                    label = "Nominal Frequency"
                    widget = edit
                    type = generic
                    default_value = "60"
                    unit = "Hz"
                    group = "Inverter Parameters"
                    nonvisible
                }

                Sinv {
                    label = "Nominal Active Power"
                    widget = edit
                    type = generic
                    default_value = "500"
                    unit = "kW"
                    group = "Inverter Parameters"
                }

                Qinv {
                    label = "Nominal Reactive Power"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "kVAR"
                    group = "Inverter Parameters"
                }

                Rac {
                    label = "Series ac resistance"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    unit = "Ω"
                    group = "Inverter Parameters"
                }

                Lac {
                    label = "Series ac inductance"
                    widget = edit
                    type = generic
                    default_value = "3e-5"
                    unit = "H"
                    group = "Inverter Parameters"
                }

                execution_rate {
                    label = "Execution rate"
                    previous_names = "Ts"
                    widget = edit
                    type = generic
                    default_value = "100e-6"
                    unit = "s"
                    group = "Execution Rate:5"
                }

                cont_t {
                    label = "Controller start time "
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "s"
                    group = "Initialization:4"
                }

                dss_ctrl {
                    label = "OpenDSS control mode"
                    widget = combo
                    combo_values = "Fixed", "PacVac", "PacQac", "VdcVac", "VdcQac"
                    type = string
                    default_value = "Fixed"
                    group = "OpenDSS Setting:6"
                    nonvisible
                    no_evaluate
                }

                Phases {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                kv {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                kw {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                pf {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                model {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                baseFreq {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                r0 {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                r1 {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                x0 {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                x1 {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                pu {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                Angle {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                Frequency {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                basekv {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                gen_ts_en {
                    label = "Enable time series"
                    widget = checkbox
                    type = bool
                    default_value = "False"
                    group = "Time Series Settings:6"
                    no_evaluate

                    CODE property_value_changed
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.enable_time_series_value_edited(mdl, container_handle, new_value)
                        comp_script.enable_time_series(mdl, container_handle, new_value)
                    ENDCODE

                    CODE property_value_edited
                        comp_script = return_comp_script(mdl, container_handle)
                        comp_script.enable_time_series_value_edited(mdl, container_handle, new_value)
                    ENDCODE
                }

                load_loadshape {
                    label = "LoadShape object"
                    widget = button
                    type = string
                    default_value = "Choose"
                    group = "Time Series Settings"
                    no_evaluate

                    CODE button_clicked
                        comp_script_load = return_comp_script_load()
                        comp_script_load.load_loadshape(mdl, container_handle)
                    ENDCODE
                }

                loadshape_name {
                    label = "LoadShape name"
                    widget = edit
                    type = generic
                    default_value = "Default"
                    group = "Time Series Settings"
                    no_evaluate

                    CODE property_value_edited
                        old_value = mdl.get_property_value(prop_handle)
                        mdl.set_property_value(prop_handle, old_value)
                    ENDCODE
                }

                loadshape_from_file {
                    label = "From CSV file"
                    widget = checkbox
                    type = generic
                    default_value = "False"
                    group = "Time Series Settings"
                    no_evaluate
                    disabled

                    CODE property_value_edited
                        old_value = mdl.get_property_value(prop_handle)
                        mdl.set_property_value(prop_handle, old_value)
                    ENDCODE
                }

                useactual {
                    label = "Actual value"
                    widget = checkbox
                    type = generic
                    default_value = "False"
                    group = "Time Series Settings"
                    no_evaluate
                    disabled
                }

                loadshape_from_file_path {
                    label = "LoadShape from file - path"
                    widget = edit
                    type = generic
                    default_value = ""
                    group = "Time Series Settings"
                    nonvisible
                    no_evaluate
                }

                loadshape_from_file_column {
                    label = "LoadShape from file - column"
                    widget = edit
                    type = generic
                    default_value = "1"
                    group = "Time Series Settings"
                    nonvisible
                    no_evaluate
                }

                loadshape_from_file_header {
                    label = "LoadShape from file - header"
                    widget = checkbox
                    type = generic
                    default_value = "True"
                    group = "Time Series Settings"
                    nonvisible
                    no_evaluate
                }

                loadshape {
                    label = "LoadShape points"
                    widget = edit
                    type = generic
                    default_value = "[0.4, 0.3, 0.2, 0.2, 0.2, 0.2, 0.3, 0.5, 0.6, 0.7, 0.7, 0.8, 0.7, 0.7, 0.8, 0.8, 0.8, 1.0, 1.0, 1.0, 1.0, 0.9, 0.7, 0.5]"
                    group = "Time Series Settings"
                    no_evaluate

                    CODE property_value_edited
                        old_value = mdl.get_property_value(prop_handle)
                        mdl.set_property_value(prop_handle, old_value)
                    ENDCODE
                }

                loadshape_int {
                    label = "LoadShape interval"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "h"
                    group = "Time Series Settings"
                    no_evaluate

                    CODE property_value_edited
                        old_value = mdl.get_property_value(prop_handle)
                        mdl.set_property_value(prop_handle, old_value)
                    ENDCODE
                }

                gen_ts_en_bit {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                T_Ts {
                    label = "LoadShape time range"
                    widget = edit
                    type = generic
                    default_value = "[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]"
                    unit = "h"
                    group = "Time Series Settings"
                }

                T_mode {
                    label = "LoadShape input mode"
                    widget = combo
                    combo_values = "Loadshape index", "Time"
                    type = string
                    default_value = "Time"
                    group = "Time Series Settings"
                    no_evaluate

                    CODE property_value_edited
                        if new_value == "Time":
                            mdl.enable_property(mdl.prop(container_handle, "T_Ts"))
                        else:
                            mdl.disable_property(mdl.prop(container_handle, "T_Ts"))
                    ENDCODE
                }

                S_Ts {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                Q_Ts {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                timespan {
                    label = "Loadshape time span"
                    widget = combo
                    combo_values = "Daily", "Yearly"
                    type = string
                    default_value = "Daily"
                    group = "Time Series Settings"
                    nonvisible
                    no_evaluate
                }

                T_Ts_internal {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                dssT {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                dssnpts {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                T_Ts_max {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                    disabled
                }

                del_Ts {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                    disabled
                }

                Slen {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                T_lim_low {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                T_lim_high {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                Ts_switch {
                    widget = edit
                    type = generic
                    default_value = "0"
                    group = "Time Series Settings"
                    nonvisible
                }

                enable_monitoring {
                    label = "Enable monitoring"
                    widget = checkbox
                    type = bool
                    default_value = "False"
                    group = "Monitoring"
                    no_evaluate
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog

                    comp_script_load = return_comp_script_load()
                    comp_script_load.read_loadshape_from_json(mdl, item_handle)

                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()

                ENDCODE

                CODE pre_compile
                    # HEADER START
                    ctrl_mode_str = mdl.get_property_value(mdl.prop(item_handle, "ctrl_mode_str"))
                    ctrl_mode_int = mdl.get_property_value(mdl.prop(item_handle, "ctrl_mode_int"))
                    ext_mode = mdl.get_property_value(mdl.prop(item_handle, "ext_mode"))
                    P_ref_str = mdl.get_property_value(mdl.prop(item_handle, "P_ref_str"))
                    P_sel = mdl.get_property_value(mdl.prop(item_handle, "P_sel"))
                    Q_ref_str = mdl.get_property_value(mdl.prop(item_handle, "Q_ref_str"))
                    Q_sel = mdl.get_property_value(mdl.prop(item_handle, "Q_sel"))
                    V_ref_str = mdl.get_property_value(mdl.prop(item_handle, "V_ref_str"))
                    V_sel = mdl.get_property_value(mdl.prop(item_handle, "V_sel"))
                    vdc_ref_str = mdl.get_property_value(mdl.prop(item_handle, "vdc_ref_str"))
                    fs_ref_str = mdl.get_property_value(mdl.prop(item_handle, "fs_ref_str"))
                    w_sel = mdl.get_property_value(mdl.prop(item_handle, "w_sel"))
                    P_kp = mdl.get_property_value(mdl.prop(item_handle, "P_kp"))
                    P_ki = mdl.get_property_value(mdl.prop(item_handle, "P_ki"))
                    Q_kp = mdl.get_property_value(mdl.prop(item_handle, "Q_kp"))
                    Q_ki = mdl.get_property_value(mdl.prop(item_handle, "Q_ki"))
                    V_kp = mdl.get_property_value(mdl.prop(item_handle, "V_kp"))
                    V_ki = mdl.get_property_value(mdl.prop(item_handle, "V_ki"))
                    vdc_kp = mdl.get_property_value(mdl.prop(item_handle, "vdc_kp"))
                    vdc_ki = mdl.get_property_value(mdl.prop(item_handle, "vdc_ki"))
                    vdc_set = mdl.get_property_value(mdl.prop(item_handle, "vdc_set"))
                    dc_cap_en = mdl.get_property_value(mdl.prop(item_handle, "dc_cap_en"))
                    dc_cap = mdl.get_property_value(mdl.prop(item_handle, "dc_cap"))
                    dc_snub = mdl.get_property_value(mdl.prop(item_handle, "dc_snub"))
                    vac_set = mdl.get_property_value(mdl.prop(item_handle, "vac_set"))
                    global_basefreq = mdl.get_property_value(mdl.prop(item_handle, "global_basefreq"))
                    Fs = mdl.get_property_value(mdl.prop(item_handle, "Fs"))
                    Sinv = mdl.get_property_value(mdl.prop(item_handle, "Sinv"))
                    Qinv = mdl.get_property_value(mdl.prop(item_handle, "Qinv"))
                    Rac = mdl.get_property_value(mdl.prop(item_handle, "Rac"))
                    Lac = mdl.get_property_value(mdl.prop(item_handle, "Lac"))
                    execution_rate = mdl.get_property_value(mdl.prop(item_handle, "execution_rate"))
                    cont_t = mdl.get_property_value(mdl.prop(item_handle, "cont_t"))
                    dss_ctrl = mdl.get_property_value(mdl.prop(item_handle, "dss_ctrl"))
                    Phases = mdl.get_property_value(mdl.prop(item_handle, "Phases"))
                    kv = mdl.get_property_value(mdl.prop(item_handle, "kv"))
                    kw = mdl.get_property_value(mdl.prop(item_handle, "kw"))
                    pf = mdl.get_property_value(mdl.prop(item_handle, "pf"))
                    model = mdl.get_property_value(mdl.prop(item_handle, "model"))
                    baseFreq = mdl.get_property_value(mdl.prop(item_handle, "baseFreq"))
                    r0 = mdl.get_property_value(mdl.prop(item_handle, "r0"))
                    r1 = mdl.get_property_value(mdl.prop(item_handle, "r1"))
                    x0 = mdl.get_property_value(mdl.prop(item_handle, "x0"))
                    x1 = mdl.get_property_value(mdl.prop(item_handle, "x1"))
                    pu = mdl.get_property_value(mdl.prop(item_handle, "pu"))
                    Angle = mdl.get_property_value(mdl.prop(item_handle, "Angle"))
                    Frequency = mdl.get_property_value(mdl.prop(item_handle, "Frequency"))
                    basekv = mdl.get_property_value(mdl.prop(item_handle, "basekv"))
                    gen_ts_en = mdl.get_property_value(mdl.prop(item_handle, "gen_ts_en"))
                    load_loadshape = mdl.get_property_value(mdl.prop(item_handle, "load_loadshape"))
                    loadshape_name = mdl.get_property_value(mdl.prop(item_handle, "loadshape_name"))
                    loadshape = mdl.get_property_value(mdl.prop(item_handle, "loadshape"))
                    loadshape_int = mdl.get_property_value(mdl.prop(item_handle, "loadshape_int"))
                    gen_ts_en_bit = mdl.get_property_value(mdl.prop(item_handle, "gen_ts_en_bit"))
                    T_mode = mdl.get_property_value(mdl.prop(item_handle, "T_mode"))
                    S_Ts = mdl.get_property_value(mdl.prop(item_handle, "S_Ts"))
                    Q_Ts = mdl.get_property_value(mdl.prop(item_handle, "Q_Ts"))
                    T_Ts = mdl.get_property_value(mdl.prop(item_handle, "T_Ts"))
                    T_Ts_internal = mdl.get_property_value(mdl.prop(item_handle, "T_Ts_internal"))
                    dssT = mdl.get_property_value(mdl.prop(item_handle, "dssT"))
                    dssnpts = mdl.get_property_value(mdl.prop(item_handle, "dssnpts"))
                    T_Ts_max = mdl.get_property_value(mdl.prop(item_handle, "T_Ts_max"))
                    del_Ts = mdl.get_property_value(mdl.prop(item_handle, "del_Ts"))
                    Slen = mdl.get_property_value(mdl.prop(item_handle, "Slen"))
                    T_lim_low = mdl.get_property_value(mdl.prop(item_handle, "T_lim_low"))
                    T_lim_high = mdl.get_property_value(mdl.prop(item_handle, "T_lim_high"))
                    Ts_switch = mdl.get_property_value(mdl.prop(item_handle, "Ts_switch"))
                    # HEADER STOP
                    prop_dict = {"vac_set": vac_set,
                                 "Sinv": Sinv,
                                 "Fs": Fs,
                                 "Qinv": Qinv,
                                 "ctrl_mode_str": ctrl_mode_str,
                                 "loadshape": loadshape,
                                 "loadshape_int": loadshape_int,
                                 "T_mode": T_mode,
                                 "T_Ts": T_Ts,
                                 }
                    comp_script = return_comp_script(mdl, item_handle)
                    comp_script.vsc_pre_compile_function(mdl, item_handle, prop_dict)

                ENDCODE

                CODE define_icon
                    comp_script = return_comp_script(mdl, item_handle)
                    comp_script.define_icon(mdl, item_handle)
                ENDCODE

                CODE init
                    import importlib

                    import dss_thcc_lib.component_scripts.comp_vsc as comp_script
                    import dss_thcc_lib.component_scripts.comp_load as comp_script2
                    importlib.reload(comp_script)
                    importlib.reload(comp_script2)

                    def return_comp_script(mdl, item_handle):
                        return comp_script

                    comp_script.resolve_backward_compatibility(mdl, item_handle)
                    def return_comp_script_load():
                        return comp_script2
                ENDCODE
            }
        }
        [
            position = 5408, 4064
            size = 220, 175
        ]
    }

}
